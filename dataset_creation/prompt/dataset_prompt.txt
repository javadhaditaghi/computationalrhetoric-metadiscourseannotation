You are an expert in academic discourse analysis specializing in metadiscourse vs. propositional classification. Analyze the provided academic text and extract every sentence with detailed annotations based on the metadiscourse framework.

## CLASSIFICATION FRAMEWORK

**Metadiscourse (Internal/Discourse-oriented)**: Organizes the text, guides the reader, signals stance/evaluation, manages writer–reader interaction, or refers to the discourse/text itself.

**Propositional (External/Content-oriented)**: States facts about the world, theories, methods, data, processes, or domain entities independent of text organization.

## CORE TESTS (Apply systematically)

1) **Truth-conditions test**: If sentence adds claims about the world that can be true/false independent of this text → Propositional. If primarily about organizing, evaluating, or attributing within this text → Metadiscourse.

2) **Deletion test**: If removing sentence leaves core factual content intact but weakens guidance/stance → Metadiscourse. If removing sentence removes or alters world-claims → Propositional.

3) **Paraphrase test**: If sentence paraphrases as 'about what the author/text is doing' → Metadiscourse. If it paraphrases as 'about phenomena, methods, results, theories' → Propositional.

## METADISCOURSE SIGNALS
- **Text organization**: 'in this section', 'however', 'therefore', 'first', 'to conclude', 'finally'
- **Code glosses**: 'that is', 'for example', 'namely', 'in other words', 'i.e.'
- **Stance markers**: 'importantly', 'we argue', 'likely', 'perhaps', 'we believe', 'it seems'
- **Attribution frames**: 'according to X', 'as noted earlier', 'previous work shows', 'Smith (2020) suggests'
- **Self-referential acts**: 'we discuss', 'this paper proposes', 'we examine', 'this study presents'

## PROPOSITIONAL SIGNALS
- **Domain facts**: 'contributes to growth', 'cells divide', 'temperature increased by 5°C'
- **Method actions**: 'we collected data', 'participants completed', 'we used ResNet-50'
- **Entities/processes**: 'dataset contains 10k images', 'reaction stops', 'X is subgraph of Y'

## SPECIAL CASES
- **Citations**: Parenthetical citations (Smith, 2020) → Metadiscourse. Integral citations as entity names 'the Smith (2020) model' → Propositional.
- **First-person verbs**: 'we show/present/argue' → Metadiscourse. 'we measured/collected/implemented' → Propositional.
- **Temporal adverbs**: 'Eventually, we discuss' → Metadiscourse. 'The reaction eventually stops' → Propositional.

## ANNOTATION TASK

For each sentence in the text, provide:

1. **sentence**: The exact sentence text (escape commas with quotes)
2. **context_before**: Preceding context (up to 150 words)
3. **context_after**: Following context (up to 150 words)
4. **section**: Section/chapter identifier (if identifiable, otherwise 'N/A')
5. **thesis_code**: Main argument this sentence supports (MAIN_ARG, EVIDENCE, COUNTER_ARG, METHOD, RESULT, DISCUSSION, CONCLUSION, etc.)
6. **expression**: Sentence's primary rhetorical function (Metadiscourse, Propositional, or Mixed if both functions are equally present)
7. **proposition_metadiscourse**: Specific metadiscourse markers present in the sentence (list key phrases separated by semicolons, or 'None' if purely propositional)

## DECISION PROCEDURE
1. Apply the three core tests to determine primary function
2. Identify specific metadiscourse markers if present
3. Assign thesis_code based on argumentative role
4. Use 'Mixed' for expression only when metadiscourse and propositional functions are truly inseparable and equally weighted

## QUALITY GUIDELINES
- Extract EVERY sentence from the text
- Be consistent in classification decisions
- Use context to disambiguate borderline cases
- Focus on the sentence's primary rhetorical function
- If uncertain, lean toward the dominant function rather than 'Mixed'

Format your response as CSV with exactly these headers:
sentence,context_before,context_after,section,thesis_code,expression,proposition_metadiscourse

Text to analyze:
{text}